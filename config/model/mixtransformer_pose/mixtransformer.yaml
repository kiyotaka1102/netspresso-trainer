model:
  task: pose_estimation
  name: mixtransformer          # <-- changed from mobilenet_v3_small
  checkpoint:
    use_pretrained: False
    load_head: False
    path: ~                  
    optimizer_path: ~
  freeze_backbone: False
  architecture:
    full: ~                     # auto
    backbone:
      name: mixtransformer      # <-- important: registry name must match the function name
      params:
        # Global parameters for all stages
        ffn_intermediate_expansion_ratio: 4      # standard SegFormer uses 4
        ffn_act_type: gelu
        ffn_dropout_prob: 0.0
        attention_dropout_prob: 0.0
      stage_params:             # 4 stages → typical MiT-B0 ~ B2 style
        - num_blocks: 2
          attention_chananels: 32               # hidden_size for stage-1
          num_attention_heads: 1
          sequence_reduction_ratio: 8
          embedding_patch_sizes: 7
          embedding_strides: 4

        - num_blocks: 2
          attention_chananels: 64
          num_attention_heads: 2
          sequence_reduction_ratio: 4
          embedding_patch_sizes: 3
          embedding_strides: 2

        - num_blocks: 6
          attention_chananels: 160
          num_attention_heads: 4
          sequence_reduction_ratio: 2
          embedding_patch_sizes: 3
          embedding_strides: 2

        - num_blocks: 3
          attention_chananels: 256
          num_attention_heads: 8
          sequence_reduction_ratio: 1
          embedding_patch_sizes: 3
          embedding_strides: 2

    neck: ~
    head:
      name: rtmcc
      params:
        conv_kernel: 7
        attention_channels: 256
        attention_act_type: 'silu'
        attention_pos_enc: False
        s: 128
        expansion_factor: 2
        dropout_rate: 0.
        drop_path: 0.
        use_rel_bias: False
        simcc_split_ratio: 2.
        target_size: [256, 256]
        # The final feature map from MixTransformer stage-4 has stride 32 (4→8→16→32)
        backbone_stride: 32
  postprocessor: 
    params: 
      simcc_split_ratio: 2.
  losses:
    - criterion: rtmcc_loss
      weight: ~